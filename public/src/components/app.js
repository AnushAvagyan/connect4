import Row from './rows.jsx';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      board: [],
      currentPlayer: 'red',
      winner: undefined,
      status: ''
    };
    this.onColClick = this.onColClick.bind(this);
  }

  createBoard() {
    for (var i = 0; i < 6; i++) {
      var row = [];

      for (let c = 0; c < 7; c++) {
        row.push(null);
      }

      this.state.board.push(row);
    }
  }

  onColClick(col) {
    if (!this.state.winner && this.checkSpace(col)) {
      for (let row = 5; row >= 0; row--) {
        if (this.state.board[row][col] === null) {
          this.state.board[row][col] = this.state.currentPlayer;
          break;
        }
      }

      this.setState({
        currentPlayer: this.state.currentPlayer === 'red' ? 'yellow' : 'red'
      });
      this.checkForWin(this.state.board);
    }
  }

  declareWin() {
    if (this.state.winner === 'red') {
      this.setState({
        status: 'Congratulations!! Red player wins!'
      });
    } else if (this.state.winner === 'yellow') {
      this.setState({
        status: 'Congratulations!! Yellow player wins!'
      });
    } else if (this.state.winner === 'tie') {
      this.setState({
        status: 'Oh-oh no winner. It is a tie. Refresh the page to play again'
      });
    }

    if (this.state.winner) {
      $.ajax({
        url: 'http://localhost:3000/gameOver',
        type: 'POST',
        data: this.state.winner,
        success: function (data) {
          $('h1').append(data);
          console.log(data);
        },
        error: function (data) {
          console.error('Failed', data);
        }
      });
    }
  }

  checkRows(board) {
    for (var row = 3; row < 6; row++) {
      for (var col = 0; col < 7; col++) {
        if (board[row][col]) {
          if (board[row][col] === board[row - 1][col] && board[row][col] === board[row - 2][col] && board[row][col] === board[row - 3][col]) {
            this.state.winner = board[row][col];
          }
        }
      }
    }
  }

  checkColumns(board) {
    for (var row = 0; row < 6; row++) {
      for (var col = 0; col < 4; col++) {
        if (board[row][col]) {
          if (board[row][col] === board[row][col + 1] && board[row][col] === board[row][col + 2] && board[row][col] === board[row][col + 3]) {
            this.state.winner = board[row][col];
          }
        }
      }
    }
  }

  checkDiagonalRight(board) {
    for (var row = 3; row < 6; row++) {
      for (var col = 0; col < 4; col++) {
        if (board[row][col]) {
          if (board[row][col] === board[row - 1][col + 1] && board[row][col] === board[row - 2][col + 2] && board[row][col] === board[row - 3][col + 3]) {
            this.state.winner = board[row][col];
          }
        }
      }
    }
  }

  checkDiagonalLeft(board) {
    for (var row = 3; row < 6; row++) {
      for (var col = 3; col < 7; col++) {
        if (board[row][col]) {
          if (board[row][col] === board[row - 1][col - 1] && board[row][col] === board[row - 2][col - 2] && board[row][col] === board[row - 3][col - 3]) {
            this.state.winner = board[row][col];
          }
        }
      }
    }
  }

  checkSpace(col) {
    for (var row = 0; row < 6; row++) {
      if (this.state.board[row][col] === null) {
        return true;
      }
    }

    return false;
  }

  checkTie(board) {
    for (var row = 0; row < 6; row++) {
      for (var col = 0; col < 7; col++) {
        if (board[row][col] === null) {
          return null;
        }
      }
    }

    this.state.winner = 'tie';
  }

  checkForWin(board) {
    this.checkRows(board);
    this.checkColumns(board);
    this.checkDiagonalRight(board);
    this.checkDiagonalLeft(board);
    this.checkTie(board);
    this.declareWin();
  }

  componentWillMount() {
    this.createBoard();
  }

  render() {
    return React.createElement("div", null, React.createElement("div", {
      className: "status"
    }, this.state.status), React.createElement("table", null, React.createElement("tbody", null, this.state.board.map((row, i) => React.createElement(Row, {
      key: i,
      row: row,
      onColClick: this.onColClick
    })))));
  }

}

export default App;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2NsaWVudC9zcmMvY29tcG9uZW50cy9hcHAuanN4Il0sIm5hbWVzIjpbIlJvdyIsIkFwcCIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInN0YXRlIiwiYm9hcmQiLCJjdXJyZW50UGxheWVyIiwid2lubmVyIiwidW5kZWZpbmVkIiwic3RhdHVzIiwib25Db2xDbGljayIsImJpbmQiLCJjcmVhdGVCb2FyZCIsImkiLCJyb3ciLCJjIiwicHVzaCIsImNvbCIsImNoZWNrU3BhY2UiLCJzZXRTdGF0ZSIsImNoZWNrRm9yV2luIiwiZGVjbGFyZVdpbiIsIiQiLCJhamF4IiwidXJsIiwidHlwZSIsImRhdGEiLCJzdWNjZXNzIiwiYXBwZW5kIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwiY2hlY2tSb3dzIiwiY2hlY2tDb2x1bW5zIiwiY2hlY2tEaWFnb25hbFJpZ2h0IiwiY2hlY2tEaWFnb25hbExlZnQiLCJjaGVja1RpZSIsImNvbXBvbmVudFdpbGxNb3VudCIsInJlbmRlciIsIm1hcCJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsR0FBUCxNQUFnQixZQUFoQjs7QUFHQSxNQUFNQyxHQUFOLFNBQWtCQyxLQUFLLENBQUNDLFNBQXhCLENBQWtDO0FBQ2hDQyxFQUFBQSxXQUFXLENBQUNDLEtBQUQsRUFBUTtBQUNqQixVQUFNQSxLQUFOO0FBQ0EsU0FBS0MsS0FBTCxHQUFhO0FBQ1hDLE1BQUFBLEtBQUssRUFBRSxFQURJO0FBRVhDLE1BQUFBLGFBQWEsRUFBRSxLQUZKO0FBR1hDLE1BQUFBLE1BQU0sRUFBRUMsU0FIRztBQUlYQyxNQUFBQSxNQUFNLEVBQUU7QUFKRyxLQUFiO0FBTUEsU0FBS0MsVUFBTCxHQUFrQixLQUFLQSxVQUFMLENBQWdCQyxJQUFoQixDQUFxQixJQUFyQixDQUFsQjtBQUdDOztBQUdEQyxFQUFBQSxXQUFXLEdBQUc7QUFFWixTQUFLLElBQUlDLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFD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cG9ydCBSb3cgZnJvbSAnLi9yb3dzLmpzeCc7XHJcblxyXG5cclxuY2xhc3MgQXBwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgYm9hcmQ6IFtdLFxyXG4gICAgICBjdXJyZW50UGxheWVyOiAncmVkJyxcclxuICAgICAgd2lubmVyOiB1bmRlZmluZWQsXHJcbiAgICAgIHN0YXR1czogJydcclxuICAgIH07XHJcbiAgICB0aGlzLm9uQ29sQ2xpY2sgPSB0aGlzLm9uQ29sQ2xpY2suYmluZCh0aGlzKTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjcmVhdGVCb2FyZCgpIHtcclxuXHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIHJvdyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgNzsgYysrKSB7XHJcbiAgICAgICAgICByb3cucHVzaChudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdGF0ZS5ib2FyZC5wdXNoKHJvdyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgb25Db2xDbGljayhjb2wpIHtcclxuICAgICAgaWYgKCF0aGlzLnN0YXRlLndpbm5lciAmJiB0aGlzLmNoZWNrU3BhY2UoY29sKSkge1xyXG5cclxuICAgICAgICBmb3IgKGxldCByb3cgPSA1OyByb3cgPj0gMDsgcm93LS0pIHtcclxuICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmJvYXJkW3Jvd11bY29sXSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmJvYXJkW3Jvd11bY29sXSA9IHRoaXMuc3RhdGUuY3VycmVudFBsYXllcjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY3VycmVudFBsYXllcjogKHRoaXMuc3RhdGUuY3VycmVudFBsYXllciA9PT0gJ3JlZCcpID8gJ3llbGxvdycgOiAncmVkJyB9KTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tGb3JXaW4odGhpcy5zdGF0ZS5ib2FyZCk7XHJcblxyXG5cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGVjbGFyZVdpbigpIHtcclxuICAgICAgaWYgKHRoaXMuc3RhdGUud2lubmVyID09PSAncmVkJykge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzdGF0dXM6ICdDb25ncmF0dWxhdGlvbnMhISBSZWQgcGxheWVyIHdpbnMhJyB9KTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlLndpbm5lciA9PT0gJ3llbGxvdycpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgc3RhdHVzOiAnQ29uZ3JhdHVsYXRpb25zISEgWWVsbG93IHBsYXllciB3aW5zIScgfSk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5zdGF0ZS53aW5uZXIgPT09ICd0aWUnKSB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHN0YXR1czogJ09oLW9oIG5vIHdpbm5lci4gSXQgaXMgYSB0aWUuIFJlZnJlc2ggdGhlIHBhZ2UgdG8gcGxheSBhZ2FpbicgfSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuc3RhdGUud2lubmVyKSB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9nYW1lT3ZlcicsXHJcbiAgICAgICAgICB0eXBlOiAnUE9TVCcsXHJcbiAgICAgICAgICBkYXRhOiB0aGlzLnN0YXRlLndpbm5lcixcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICQoJ2gxJykuYXBwZW5kKGRhdGEpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkJywgZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrUm93cyhib2FyZCkge1xyXG5cclxuICAgICAgZm9yICh2YXIgcm93ID0gMzsgcm93IDwgNjsgcm93KyspIHtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgNzsgY29sKyspIHtcclxuICAgICAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0pIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0gPT09IGJvYXJkW3JvdyAtIDFdW2NvbF0gJiYgYm9hcmRbcm93XVtjb2xdID09PSBib2FyZFtyb3cgLSAyXVtjb2xdICYmIGJvYXJkW3Jvd11bY29sXSA9PT0gYm9hcmRbcm93IC0gM11bY29sXSkge1xyXG5cclxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLndpbm5lciA9IGJvYXJkW3Jvd11bY29sXTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja0NvbHVtbnMoYm9hcmQpIHtcclxuICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgNjsgcm93KyspIHtcclxuICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCA0OyBjb2wrKykge1xyXG4gICAgICAgICAgaWYgKGJvYXJkW3Jvd11bY29sXSkge1xyXG4gICAgICAgICAgICBpZiAoYm9hcmRbcm93XVtjb2xdID09PSBib2FyZFtyb3ddW2NvbCArIDFdICYmIGJvYXJkW3Jvd11bY29sXSA9PT0gYm9hcmRbcm93XVtjb2wgKyAyXSAmJiBib2FyZFtyb3ddW2NvbF0gPT09IGJvYXJkW3Jvd11bY29sICsgM10pIHtcclxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLndpbm5lciA9IGJvYXJkW3Jvd11bY29sXTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja0RpYWdvbmFsUmlnaHQoYm9hcmQpIHtcclxuXHJcbiAgICAgIGZvciAodmFyIHJvdyA9IDM7IHJvdyA8IDY7IHJvdysrKSB7XHJcbiAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgNDsgY29sKyspIHtcclxuICAgICAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0pIHtcclxuICAgICAgICAgICAgaWYgKGJvYXJkW3Jvd11bY29sXSA9PT0gYm9hcmRbcm93IC0gMV1bY29sICsgMV0gJiYgYm9hcmRbcm93XVtjb2xdID09PSBib2FyZFtyb3cgLSAyXVtjb2wgKyAyXSAmJiBib2FyZFtyb3ddW2NvbF0gPT09IGJvYXJkW3JvdyAtIDNdW2NvbCArIDNdKSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUud2lubmVyID0gYm9hcmRbcm93XVtjb2xdO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrRGlhZ29uYWxMZWZ0KGJvYXJkKSB7XHJcblxyXG4gICAgICBmb3IgKHZhciByb3cgPSAzOyByb3cgPCA2OyByb3crKykge1xyXG4gICAgICAgIGZvciAodmFyIGNvbCA9IDM7IGNvbCA8IDc7IGNvbCsrKSB7XHJcbiAgICAgICAgICBpZiAoYm9hcmRbcm93XVtjb2xdKSB7XHJcbiAgICAgICAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0gPT09IGJvYXJkW3JvdyAtIDFdW2NvbCAtIDFdICYmIGJvYXJkW3Jvd11bY29sXSA9PT0gYm9hcmRbcm93IC0gMl1bY29sIC0gMl0gJiYgYm9hcmRbcm93XVtjb2xdID09PSBib2FyZFtyb3cgLSAzXVtjb2wgLSAzXSkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc3RhdGUud2lubmVyID0gYm9hcmRbcm93XVtjb2xdO1xyXG5cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja1NwYWNlKGNvbCkge1xyXG4gICAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCA2OyByb3crKykge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmJvYXJkW3Jvd11bY29sXSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrVGllKGJvYXJkKSB7XHJcbiAgICAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IDY7IHJvdysrKSB7XHJcbiAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgNzsgY29sKyspIHtcclxuICAgICAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3RhdGUud2lubmVyID0gJ3RpZSc7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tGb3JXaW4oYm9hcmQpIHtcclxuICAgICAgdGhpcy5jaGVja1Jvd3MoYm9hcmQpO1xyXG4gICAgICB0aGlzLmNoZWNrQ29sdW1ucyhib2FyZCk7XHJcbiAgICAgIHRoaXMuY2hlY2tEaWFnb25hbFJpZ2h0KGJvYXJkKTtcclxuICAgICAgdGhpcy5jaGVja0RpYWdvbmFsTGVmdChib2FyZCk7XHJcbiAgICAgIHRoaXMuY2hlY2tUaWUoYm9hcmQpO1xyXG4gICAgICB0aGlzLmRlY2xhcmVXaW4oKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY29tcG9uZW50V2lsbE1vdW50KCkge1xyXG4gICAgICB0aGlzLmNyZWF0ZUJvYXJkKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgcmV0dXJuIChcclxuICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdGF0dXNcIj57dGhpcy5zdGF0ZS5zdGF0dXN9PC9kaXY+XHJcbiAgICAgICAgICA8dGFibGU+XHJcbiAgICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5ib2FyZC5tYXAoKHJvdywgaSkgPT4gKDxSb3cga2V5PXtpfSByb3c9e3Jvd30gb25Db2xDbGljaz17dGhpcy5vbkNvbENsaWNrfSAvPikpfVxyXG4gICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG4gIGV4cG9ydCBkZWZhdWx0IEFwcDsiXX0=